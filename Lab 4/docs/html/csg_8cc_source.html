<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Tracy: csg.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tracy
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">csg.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="csg_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Made by Mathias Broxvall </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">   Copyright (C) 2007  Mathias Broxvall</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">   along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="general_8h.html">general.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="csg_8h.html">csg.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_intersection.html#a67497e3efe2793b23909052eeb82c4f3">   30</a></span>&#160;<a class="code" href="class_intersection.html#a67497e3efe2793b23909052eeb82c4f3">Intersection::Intersection</a>() {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  objects = <span class="keyword">new</span> std::set&lt;Object*&gt;();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="general_8h.html#a44940083ba78c21d097d37dcc0a49aec">MAX_OMP_THREADS</a>;i++) lastObject[i] = NULL;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_intersection.html#a064951a970ed8dd11081b2903ab62122">   34</a></span>&#160;<a class="code" href="class_intersection.html#a064951a970ed8dd11081b2903ab62122">Intersection::~Intersection</a>() {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  set&lt;Object*&gt;::iterator objIterator;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  set&lt;Object*&gt;::iterator objIteratorEnd;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span>(objIterator=objects-&gt;begin(),objIteratorEnd=objects-&gt;end();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      objIterator != objIteratorEnd;objIterator++) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    (*objIterator)-&gt;dereference();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="class_intersection.html#a62cc72188b282d2887f5979e7b5f5325">   42</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_intersection.html#a62cc72188b282d2887f5979e7b5f5325">Intersection::addObject</a>(<a class="code" href="class_object.html">Object</a> *<span class="keywordtype">object</span>) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">object</span>-&gt;reference();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  objects-&gt;insert(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="class_intersection.html#acadaeb4e35a52f4d1ff80769586921ff">   47</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_intersection.html#acadaeb4e35a52f4d1ff80769586921ff">Intersection::lineTest</a>(<span class="keywordtype">double</span> O1[3],<span class="keywordtype">double</span> dir[3],<span class="keywordtype">double</span> maxDistance) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">bool</span> findOutsides;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span> O[3],point[3];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">double</span> dist, progress, offset;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  set&lt;Object*&gt;::iterator objIterator;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  set&lt;Object*&gt;::iterator objIteratorEnd;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">/*  This is just to illustrate how you can debug your linetest functions */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="general_8h.html#a030f3c150bfe06af45f51ded93eb4d57">debugThisPixel</a>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="general_8h.html#ae1c327e9afb4e6ccd35029355384fe71">printDebugIndentation</a>(); </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    printf(<span class="stringliteral">&quot;-&gt; Intersection::lineTest\n&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="general_8h.html#a5906e7ce057ac03baa7e87832fcad510">debugIndentation</a>++;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  findOutsides = isInside(O1);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="vector_8cc.html#ae3e07fa99d972082756ecc59df6aa880">assign</a>(O1,O);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  offset=0.0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">while</span>(1) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    progress = maxDistance;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    dist = maxDistance;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span>(objIterator=objects-&gt;begin(),objIteratorEnd=objects-&gt;end();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        objIterator != objIteratorEnd;objIterator++) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="keywordtype">double</span> thisDist = (*objIterator)-&gt;lineTest(O,dir,maxDistance);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">if</span>(thisDist &gt;= maxDistance) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span>(thisDist &lt; progress) progress = thisDist + 1e-5;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">for</span>(i=0;i&lt;3;i++) point[i] = O[i]+(thisDist+1e-3)*dir[i];</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span>(thisDist &lt; dist &amp;&amp; (isInside(point) ^ findOutsides)) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        dist = thisDist;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        lastObject[omp_get_thread_num()] = *objIterator;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }  </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span>(dist &lt; maxDistance) </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">/* Found closest point inside all objects */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">break</span>; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(progress &gt;= maxDistance) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">/* no intersection with any points found */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="general_8h.html#a030f3c150bfe06af45f51ded93eb4d57">debugThisPixel</a>) { <a class="code" href="general_8h.html#a5906e7ce057ac03baa7e87832fcad510">debugIndentation</a>--; <a class="code" href="general_8h.html#ae1c327e9afb4e6ccd35029355384fe71">printDebugIndentation</a>(); printf(<span class="stringliteral">&quot;&lt;- miss (1)\n&quot;</span>); }      </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="object_8h.html#a08e4da5f3d0c7936fa52467f40e4b6aa">MAX_DISTANCE</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="comment">/* If no line intersection that satisfied the inside test was</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">      found, we have to try again from a new vantage point to find the</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">      next set of solutions for each object, if it exists. */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">if</span>(progress &lt; 1e-5) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        printf(<span class="stringliteral">&quot;ERROR\n&quot;</span>); exit(0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">for</span>(i=0;i&lt;3;i++) O[i] += progress*dir[i];      </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      offset += progress;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      maxDistance -= progress;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span>(maxDistance &lt; 0.0) </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">/* We have progresses too far ahead, intersections no longer</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">           interesting */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="general_8h.html#a030f3c150bfe06af45f51ded93eb4d57">debugThisPixel</a>) { <a class="code" href="general_8h.html#a5906e7ce057ac03baa7e87832fcad510">debugIndentation</a>--; <a class="code" href="general_8h.html#ae1c327e9afb4e6ccd35029355384fe71">printDebugIndentation</a>(); printf(<span class="stringliteral">&quot;&lt;- miss (2)\n&quot;</span>); }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="object_8h.html#a08e4da5f3d0c7936fa52467f40e4b6aa">MAX_DISTANCE</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="general_8h.html#a030f3c150bfe06af45f51ded93eb4d57">debugThisPixel</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="general_8h.html#a5906e7ce057ac03baa7e87832fcad510">debugIndentation</a>--; <a class="code" href="general_8h.html#ae1c327e9afb4e6ccd35029355384fe71">printDebugIndentation</a>(); </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    printf(<span class="stringliteral">&quot;&lt;- %3.2f\n&quot;</span>,dist+offset);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">return</span> dist + offset;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="class_intersection.html#aca5201537e1f12305142be681b0e0b47">  114</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_intersection.html#aca5201537e1f12305142be681b0e0b47">Intersection::getNormal</a>(<span class="keywordtype">double</span> point[3],<span class="keywordtype">double</span> normal[3]) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">/* Simplifying assumption, this function is only called after a</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  successfull lineintersection test. Otherwise we would have to</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  compute which object is actually the limiting object at this point.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  This is a lot faster than the alternative to compute the correct</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">  intersecting point, but it is not correct when running with multiple</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  threads and not even with a single thread and some special scene</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  graphs. */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  lastObject[omp_get_thread_num()]-&gt;getNormal(point,normal);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_intersection.html#acbba7803bcd3928967fd675992a8ae96">  125</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_intersection.html#acbba7803bcd3928967fd675992a8ae96">Intersection::isInside</a>(<span class="keywordtype">double</span> point[3]) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">/* Iterate over all objects, return true if we are inside all of</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">     them */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  set&lt;Object*&gt;::iterator objIterator;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  set&lt;Object*&gt;::iterator objIteratorEnd;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">for</span>(objIterator=objects-&gt;begin(),objIteratorEnd=objects-&gt;end();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      objIterator != objIteratorEnd;objIterator++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span>(!(*objIterator)-&gt;isInside(point)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }  </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="class_intersection.html#aeaf604c0cdbef2d4c2a0f2087287ead8">  137</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_intersection.html#aeaf604c0cdbef2d4c2a0f2087287ead8">Intersection::getLightingProperties</a>(<span class="keywordtype">double</span> point[3],<a class="code" href="class_lighting_properties.html">LightingProperties</a> *props,<span class="keywordtype">double</span> normal[3]) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">/* Simplifying assumption, this function is only called after a</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">  successfull lineintersection test. Otherwise we would have to</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">  compute which object is actually the limiting object at this point.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  This is a lot faster than the alternative to compute the correct</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">  intersecting point, but it is not correct when running with multiple</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">  threads and not even with a single thread and some special scene</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">  graphs. */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  lastObject[omp_get_thread_num()]-&gt;getLightingProperties(point,props,normal);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="class_inverse.html#ab465fd57124caf679827ec3dddabe2ea">  148</a></span>&#160;<a class="code" href="class_inverse.html#ab465fd57124caf679827ec3dddabe2ea">Inverse::Inverse</a>(<a class="code" href="class_object.html">Object</a> *o) { <span class="keywordtype">object</span>=o; o-&gt;<a class="code" href="class_referenced_object.html#a0fc8392b9b02ce8203f7e01ee150397d">reference</a>(); }</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="class_inverse.html#a21add8a55de3e5c898701e0a22a12cc1">  149</a></span>&#160;<a class="code" href="class_inverse.html#a21add8a55de3e5c898701e0a22a12cc1">Inverse::~Inverse</a>() { <span class="keywordtype">object</span>-&gt;dereference(); }</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="class_inverse.html#a7cd665a12ccf90142526965dfe416d1f">  150</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_inverse.html#a7cd665a12ccf90142526965dfe416d1f">Inverse::lineTest</a>(<span class="keywordtype">double</span> origin[3],<span class="keywordtype">double</span> direction[3],<span class="keywordtype">double</span> maxDistance) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">return</span> <span class="keywordtype">object</span>-&gt;lineTest(origin,direction,maxDistance);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="class_inverse.html#aead295a76d1bd7d8478fc0e32710c84f">  153</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_inverse.html#aead295a76d1bd7d8478fc0e32710c84f">Inverse::getNormal</a>(<span class="keywordtype">double</span> point[3],<span class="keywordtype">double</span> normal[3]) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keywordtype">object</span>-&gt;getNormal(point,normal);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;3;i++) normal[i] = -normal[i];  </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="class_inverse.html#af3747e94047e18d4eff0fc61a92bf915">  158</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_inverse.html#af3747e94047e18d4eff0fc61a92bf915">Inverse::isInside</a>(<span class="keywordtype">double</span> point[3]) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">return</span> !<span class="keywordtype">object</span>-&gt;isInside(point);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="class_inverse.html#abedf66c2607143f237f913187ecfdc40">  161</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_inverse.html#abedf66c2607143f237f913187ecfdc40">Inverse::getLightingProperties</a>(<span class="keywordtype">double</span> point[3],<a class="code" href="class_lighting_properties.html">LightingProperties</a> *props,<span class="keywordtype">double</span> normal[3]) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;3;i++) normal[i] = -normal[i];  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">object</span>-&gt;getLightingProperties(point,props,normal);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span>(i=0;i&lt;3;i++) normal[i] = -normal[i];  </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="ttc" id="vector_8cc_html_ae3e07fa99d972082756ecc59df6aa880"><div class="ttname"><a href="vector_8cc.html#ae3e07fa99d972082756ecc59df6aa880">assign</a></div><div class="ttdeci">void assign(const Matrix4d A, Matrix4d C)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8cc_source.html#l00138">vector.cc:138</a></div></div>
<div class="ttc" id="class_intersection_html_aeaf604c0cdbef2d4c2a0f2087287ead8"><div class="ttname"><a href="class_intersection.html#aeaf604c0cdbef2d4c2a0f2087287ead8">Intersection::getLightingProperties</a></div><div class="ttdeci">void getLightingProperties(double point[3], LightingProperties *props, double normal[3])</div><div class="ttdoc">Default material handling that queries the default material given for this object. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00137">csg.cc:137</a></div></div>
<div class="ttc" id="general_8h_html_a5906e7ce057ac03baa7e87832fcad510"><div class="ttname"><a href="general_8h.html#a5906e7ce057ac03baa7e87832fcad510">debugIndentation</a></div><div class="ttdeci">int debugIndentation</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00084">main.cc:84</a></div></div>
<div class="ttc" id="class_inverse_html_af3747e94047e18d4eff0fc61a92bf915"><div class="ttname"><a href="class_inverse.html#af3747e94047e18d4eff0fc61a92bf915">Inverse::isInside</a></div><div class="ttdeci">bool isInside(double point[3])</div><div class="ttdoc">Tests if a point is inside the object or not. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00158">csg.cc:158</a></div></div>
<div class="ttc" id="object_8h_html_a08e4da5f3d0c7936fa52467f40e4b6aa"><div class="ttname"><a href="object_8h.html#a08e4da5f3d0c7936fa52467f40e4b6aa">MAX_DISTANCE</a></div><div class="ttdeci">#define MAX_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00032">object.h:32</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="general_8h_html_a44940083ba78c21d097d37dcc0a49aec"><div class="ttname"><a href="general_8h.html#a44940083ba78c21d097d37dcc0a49aec">MAX_OMP_THREADS</a></div><div class="ttdeci">#define MAX_OMP_THREADS</div><div class="ttdef"><b>Definition:</b> <a href="general_8h_source.html#l00057">general.h:57</a></div></div>
<div class="ttc" id="general_8h_html_ae1c327e9afb4e6ccd35029355384fe71"><div class="ttname"><a href="general_8h.html#ae1c327e9afb4e6ccd35029355384fe71">printDebugIndentation</a></div><div class="ttdeci">void printDebugIndentation()</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00291">main.cc:291</a></div></div>
<div class="ttc" id="class_inverse_html_a21add8a55de3e5c898701e0a22a12cc1"><div class="ttname"><a href="class_inverse.html#a21add8a55de3e5c898701e0a22a12cc1">Inverse::~Inverse</a></div><div class="ttdeci">~Inverse()</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00149">csg.cc:149</a></div></div>
<div class="ttc" id="class_inverse_html_a7cd665a12ccf90142526965dfe416d1f"><div class="ttname"><a href="class_inverse.html#a7cd665a12ccf90142526965dfe416d1f">Inverse::lineTest</a></div><div class="ttdeci">double lineTest(double origin[3], double direction[3], double maxDistance)</div><div class="ttdoc">Must do the line intersection test and return the closest distance in which a ray originating in orig...</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00150">csg.cc:150</a></div></div>
<div class="ttc" id="class_inverse_html_ab465fd57124caf679827ec3dddabe2ea"><div class="ttname"><a href="class_inverse.html#ab465fd57124caf679827ec3dddabe2ea">Inverse::Inverse</a></div><div class="ttdeci">Inverse(Object *)</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00148">csg.cc:148</a></div></div>
<div class="ttc" id="class_intersection_html_a67497e3efe2793b23909052eeb82c4f3"><div class="ttname"><a href="class_intersection.html#a67497e3efe2793b23909052eeb82c4f3">Intersection::Intersection</a></div><div class="ttdeci">Intersection()</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00030">csg.cc:30</a></div></div>
<div class="ttc" id="class_intersection_html_a064951a970ed8dd11081b2903ab62122"><div class="ttname"><a href="class_intersection.html#a064951a970ed8dd11081b2903ab62122">Intersection::~Intersection</a></div><div class="ttdeci">~Intersection()</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00034">csg.cc:34</a></div></div>
<div class="ttc" id="general_8h_html"><div class="ttname"><a href="general_8h.html">general.h</a></div><div class="ttdoc">Contains common type definitions, includes, etc. </div></div>
<div class="ttc" id="class_inverse_html_aead295a76d1bd7d8478fc0e32710c84f"><div class="ttname"><a href="class_inverse.html#aead295a76d1bd7d8478fc0e32710c84f">Inverse::getNormal</a></div><div class="ttdeci">void getNormal(double point[3], double normal[3])</div><div class="ttdoc">Compute the normal of the object at the given point. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00153">csg.cc:153</a></div></div>
<div class="ttc" id="class_lighting_properties_html"><div class="ttname"><a href="class_lighting_properties.html">LightingProperties</a></div><div class="ttdoc">Stores lighting properties used for Phong lighting, reflections and transparancy. ...</div><div class="ttdef"><b>Definition:</b> <a href="material_8h_source.html#l00037">material.h:37</a></div></div>
<div class="ttc" id="class_intersection_html_acadaeb4e35a52f4d1ff80769586921ff"><div class="ttname"><a href="class_intersection.html#acadaeb4e35a52f4d1ff80769586921ff">Intersection::lineTest</a></div><div class="ttdeci">double lineTest(double origin[3], double direction[3], double maxDistance)</div><div class="ttdoc">Must do the line intersection test and return the closest distance in which a ray originating in orig...</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00047">csg.cc:47</a></div></div>
<div class="ttc" id="class_object_html"><div class="ttname"><a href="class_object.html">Object</a></div><div class="ttdoc">Abstract base class for all renderable objects. </div><div class="ttdef"><b>Definition:</b> <a href="object_8h_source.html#l00039">object.h:39</a></div></div>
<div class="ttc" id="class_intersection_html_aca5201537e1f12305142be681b0e0b47"><div class="ttname"><a href="class_intersection.html#aca5201537e1f12305142be681b0e0b47">Intersection::getNormal</a></div><div class="ttdeci">void getNormal(double point[3], double normal[3])</div><div class="ttdoc">Compute the normal of the object at the given point. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00114">csg.cc:114</a></div></div>
<div class="ttc" id="class_intersection_html_a62cc72188b282d2887f5979e7b5f5325"><div class="ttname"><a href="class_intersection.html#a62cc72188b282d2887f5979e7b5f5325">Intersection::addObject</a></div><div class="ttdeci">void addObject(Object *)</div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00042">csg.cc:42</a></div></div>
<div class="ttc" id="class_intersection_html_acbba7803bcd3928967fd675992a8ae96"><div class="ttname"><a href="class_intersection.html#acbba7803bcd3928967fd675992a8ae96">Intersection::isInside</a></div><div class="ttdeci">bool isInside(double point[3])</div><div class="ttdoc">Tests if a point is inside the object or not. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00125">csg.cc:125</a></div></div>
<div class="ttc" id="class_referenced_object_html_a0fc8392b9b02ce8203f7e01ee150397d"><div class="ttname"><a href="class_referenced_object.html#a0fc8392b9b02ce8203f7e01ee150397d">ReferencedObject::reference</a></div><div class="ttdeci">void reference()</div><div class="ttdoc">Call when an object reference is added to memory. </div><div class="ttdef"><b>Definition:</b> <a href="referenced_8cc_source.html#l00032">referenced.cc:32</a></div></div>
<div class="ttc" id="general_8h_html_a030f3c150bfe06af45f51ded93eb4d57"><div class="ttname"><a href="general_8h.html#a030f3c150bfe06af45f51ded93eb4d57">debugThisPixel</a></div><div class="ttdeci">int debugThisPixel</div><div class="ttdef"><b>Definition:</b> <a href="main_8cc_source.html#l00083">main.cc:83</a></div></div>
<div class="ttc" id="class_inverse_html_abedf66c2607143f237f913187ecfdc40"><div class="ttname"><a href="class_inverse.html#abedf66c2607143f237f913187ecfdc40">Inverse::getLightingProperties</a></div><div class="ttdeci">void getLightingProperties(double point[3], LightingProperties *props, double normal[3])</div><div class="ttdoc">Default material handling that queries the default material given for this object. </div><div class="ttdef"><b>Definition:</b> <a href="csg_8cc_source.html#l00161">csg.cc:161</a></div></div>
<div class="ttc" id="csg_8h_html"><div class="ttname"><a href="csg_8h.html">csg.h</a></div><div class="ttdoc">Declares all methods for all CSG classes (Intersection, Inverse) </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Nov 11 2014 14:15:02 for Tracy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
